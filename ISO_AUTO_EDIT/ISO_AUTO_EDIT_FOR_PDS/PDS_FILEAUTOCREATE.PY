import os
import shutil
import sys

def rename_pds_files():
    """í˜„ì¬ ë””ë ‰í† ë¦¬ì—ì„œ PDSë¡œ ì‹œì‘í•˜ëŠ” .py íŒŒì¼ë“¤ì„ PDS_ONìœ¼ë¡œ ì´ë¦„ ë³€ê²½"""
    
    # ì´ í”„ë¡œê·¸ë¨ íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ ê°€ì ¸ì˜¤ê¸°
    current_dir = os.path.dirname(os.path.abspath(__file__))
    print(f"\ní”„ë¡œê·¸ë¨ íŒŒì¼ ìœ„ì¹˜: {current_dir}")
    print("-" * 50)
    
    # ì²˜ë¦¬ëœ íŒŒì¼ ìˆ˜ ì¹´ìš´í„°
    copied_count = 0
    skipped_count = 0
    error_count = 0
    
    # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ ëª¨ë“  íŒŒì¼ í™•ì¸
    try:
        files = [f for f in os.listdir(current_dir) if os.path.isfile(os.path.join(current_dir, f))]
    except Exception as e:
        print(f"âŒ ë””ë ‰í† ë¦¬ ì½ê¸° ì˜¤ë¥˜: {str(e)}")
        return
    
    # ë””ë²„ê¹…: ëª¨ë“  íŒŒì¼ ëª©ë¡ ì¶œë ¥
    print(f"ğŸ“ í´ë” ë‚´ ì „ì²´ íŒŒì¼ ìˆ˜: {len(files)}")
    print("\nğŸ“„ ëª¨ë“  íŒŒì¼ ëª©ë¡:")
    for i, filename in enumerate(files, 1):
        print(f"  {i:2d}. {filename}")
    
    print("\n" + "-" * 30)
    
    # PDSë¡œ ì‹œì‘í•˜ëŠ” .py íŒŒì¼ë“¤ ì°¾ê¸°
    pds_files = []
    py_files = []
    
    for filename in files:
        # ëª¨ë“  .py íŒŒì¼ ìˆ˜ì§‘ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´)
        if filename.lower().endswith('.py'):
            py_files.append(filename)
            
            # PDSë¡œ ì‹œì‘í•˜ê³  PDS_ONìœ¼ë¡œ ì‹œì‘í•˜ì§€ ì•ŠëŠ” íŒŒì¼
            if (filename.startswith('PDS') and 
                not filename.startswith('PDS_ON')):
                pds_files.append(filename)
    
    print(f"ğŸ Python íŒŒì¼ ìˆ˜: {len(py_files)}")
    if py_files:
        for py_file in py_files:
            status = "âœ… ëŒ€ìƒ" if py_file in pds_files else "â­ï¸ ì œì™¸"
            print(f"     {status}: {py_file}")
    
    print(f"\nğŸ¯ ì²˜ë¦¬ ëŒ€ìƒ PDS íŒŒì¼ ìˆ˜: {len(pds_files)}")
    if pds_files:
        for pds_file in pds_files:
            print(f"     â–¶ï¸  {pds_file}")
    
    if not pds_files:
        print("ğŸ” PDSë¡œ ì‹œì‘í•˜ëŠ” .py íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
        return
    
    print(f"ğŸ“ ë°œê²¬ëœ PDS íŒŒì¼ ìˆ˜: {len(pds_files)}")
    print("-" * 30)
    
    # ê° íŒŒì¼ ì²˜ë¦¬
    for filename in pds_files:
        old_path = os.path.join(current_dir, filename)
        
        try:
            # ìƒˆ íŒŒì¼ëª… ìƒì„±: PDSë¥¼ PDS_ONìœ¼ë¡œ ë³€ê²½í•˜ê³  ë’¤ì˜ ë¬¸ìëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
            # PDS ë’¤ì˜ ëª¨ë“  ë¬¸ìë¥¼ ì¶”ì¶œ
            remaining_part = filename[3:]  # PDS(3ê¸€ì) ë’¤ì˜ ëª¨ë“  ë¬¸ì
            new_filename = f"PDS_ON{remaining_part}"
            
            new_path = os.path.join(current_dir, new_filename)
            
            # ëŒ€ìƒ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
            if os.path.exists(new_path):
                print(f"âš ï¸  ì´ë¯¸ ì¡´ì¬í•¨: {new_filename}")
                skipped_count += 1
            else:
                # íŒŒì¼ ë³µì‚¬
                import shutil
                shutil.copy2(old_path, new_path)
                print(f"âœ… ë³µì‚¬ ìƒì„±: {filename} â†’ {new_filename}")
                copied_count += 1
                
        except Exception as e:
            print(f"âŒ ì˜¤ë¥˜ ë°œìƒ ({filename}): {str(e)}")
            error_count += 1
    
    # ì²˜ë¦¬ ê²°ê³¼ ì¶œë ¥
    print("\n" + "="*50)
    print(f"ğŸ¯ ì²˜ë¦¬ ì™„ë£Œ!")
    print(f"âœ… ë³µì‚¬ ìƒì„±ëœ íŒŒì¼ ìˆ˜: {copied_count}")
    print(f"â­ï¸  ê±´ë„ˆë›´ íŒŒì¼ ìˆ˜: {skipped_count}")
    print(f"âŒ ì˜¤ë¥˜ ë°œìƒ íŒŒì¼ ìˆ˜: {error_count}")
    print("="*50)

def main():
    """í”„ë¡œê·¸ë¨ ì‹¤í–‰"""
    print("\n" + "="*50)
    print("PDS íŒŒì¼ ì´ë¦„ ë³€ê²½ í”„ë¡œê·¸ë¨")
    print("="*50)
    print("\nì´ í”„ë¡œê·¸ë¨ì€ í˜„ì¬ ë””ë ‰í† ë¦¬ì—ì„œ:")
    print("1. 'PDS'ë¡œ ì‹œì‘í•˜ëŠ” .py íŒŒì¼ì„ ì°¾ìŠµë‹ˆë‹¤")
    print("2. ì›ë³¸ì€ ê·¸ëŒ€ë¡œ ë‘ê³  'PDS_ON'ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë³µì‚¬ë³¸ì„ ìƒì„±í•©ë‹ˆë‹¤")
    print("3. ì´ë¯¸ 'PDS_ON'ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” íŒŒì¼ì€ ê±´ë„ˆëœë‹ˆë‹¤")
    print("-" * 50)
    
    # ì‚¬ìš©ì í™•ì¸
    try:
        confirm = input("\nê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N): ").strip().lower()
        if confirm in ['y', 'yes']:
            rename_pds_files()
        else:
            print("ì‘ì—…ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
    except KeyboardInterrupt:
        print("\n\nì‘ì—…ì´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.")
    
    input("\nì¢…ë£Œí•˜ë ¤ë©´ Enter í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”...")

if __name__ == "__main__":
    main()