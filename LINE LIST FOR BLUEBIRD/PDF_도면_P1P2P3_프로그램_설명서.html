
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>PDF 도면 자동 분석 프로그램 (P1 → P2 → P3) 설명서</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 960px;
            margin: auto;
            padding: 40px;
            background: #ffffff;
        }
        h1 {
            border-bottom: 3px solid #444;
            padding-bottom: 10px;
            color: #2c3e50;
        }
        h2 {
            margin-top: 30px;
            color: #2c3e50;
            border-left: 6px solid #888;
            padding-left: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #999;
            padding: 8px;
        }
        th {
            background-color: #f0f0f0;
        }
        code {
            background-color: #eee;
            padding: 2px 4px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>PDF 도면 자동 분석 프로그램 (P1 → P2 → P3) 설명서</h1>

    <h2>1. 프로그램 개요</h2>
    <p>
        본 프로그램은 PDF로 된 도면 내에서 P1 → P2 → P3 구조를 인식하여 LINE NO와 VALVE NO를 자동 추출하고,
        텍스트를 하이라이트 처리한 PDF와 중복 검출된 항목을 CSV로 저장하는 자동화 분석 도구입니다.
    </p>

    <h2>2. 인식 구조 정의</h2>
    <table>
        <thead>
            <tr><th>구분</th><th>정규식 조건</th><th>예시</th></tr>
        </thead>
        <tbody>
            <tr><td><strong>P1</strong></td><td><code>^(00|11|21|22)[A-Za-z0-9]{0,7}$</code></td><td>00X001, 11A0003</td></tr>
            <tr><td><strong>P2</strong></td><td><code>^(BR|AA)[A-Za-z0-9]{0,8}$</code></td><td>BR01, AA1234</td></tr>
            <tr><td><strong>P3 (DN)</strong></td><td><code>^DN.{0,11}$</code></td><td>DN80, DN150H</td></tr>
            <tr><td><strong>P3 (H)</strong></td><td><code>^H.{0,11}$</code> (거리 20 이하에서)</td><td>H, H150</td></tr>
        </tbody>
    </table>

    <h2>3. 주요 기능</h2>
    <ul>
        <li><strong>LINE NO 생성:</strong> P2가 BR일 경우 P1-P2-P3 조합으로 구성</li>
        <li><strong>VALVE NO 생성:</strong> P2가 AA일 경우 P1-P2 조합으로 구성</li>
        <li><strong>DN과 H를 근접 기준으로 병합 처리</strong></li>
        <li><strong>중복 항목 감지 및 분리 하이라이트</strong></li>
    </ul>

    <h2>4. 하이라이트 색상</h2>
    <table>
        <thead>
            <tr><th>항목</th><th>색상</th><th>설명</th></tr>
        </thead>
        <tbody>
            <tr><td>P1</td><td>녹색 (0,1,0)</td><td>기준 텍스트</td></tr>
            <tr><td>P2</td><td>주황색 (1,0.5,0)</td><td>BR 또는 AA</td></tr>
            <tr><td>P3</td><td>파랑색 (0,0,1)</td><td>DN 또는 H</td></tr>
            <tr><td>DUP PDF</td><td>첫 항목 파랑 / 이후 빨강</td><td>중복 항목 구분</td></tr>
        </tbody>
    </table>

    <h2>5. 출력 파일</h2>
    <table>
        <thead>
            <tr><th>파일명</th><th>형식</th><th>설명</th></tr>
        </thead>
        <tbody>
            <tr><td>LINE_파일명.csv</td><td>CSV</td><td>P1, P2, P3, LINE NO, 중복 여부</td></tr>
            <tr><td>VALVE_파일명.csv</td><td>CSV</td><td>P1, P2, VALVE NO, 중복 여부</td></tr>
            <tr><td>OUT_파일명.pdf</td><td>PDF</td><td>인식된 모든 항목에 하이라이트 표시</td></tr>
            <tr><td>DUP_파일명.pdf</td><td>PDF</td><td>중복된 VALVE NO만 하이라이트</td></tr>
        </tbody>
    </table>

    <h2>6. 실행 및 사용 방법</h2>
    <ol>
        <li>실행 후 다중 PDF 파일을 선택</li>
        <li>자동으로 분석 및 결과 파일 생성</li>
        <li>동일 폴더에 PDF 및 CSV 출력 저장됨</li>
    </ol>

    <h2>7. 기술 스택</h2>
    <ul>
        <li><strong>PyMuPDF (fitz)</strong>: PDF 좌표 및 텍스트 추출, 하이라이트 삽입</li>
        <li><strong>re</strong>: 정규식 기반 텍스트 필터링</li>
        <li><strong>csv, os</strong>: 파일 저장 및 이름 구성</li>
        <li><strong>math</strong>: 중심 좌표 계산 및 거리 측정</li>
        <li><strong>tkinter</strong>: 파일 선택 GUI</li>
    </ul>
</div>
</body>
</html>
